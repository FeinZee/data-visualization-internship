# 需求分析

> 背景

百度统计、谷歌统计、友盟统计收集了指定网站的每日pv、uv等访客数据，通过这些统计平台提供的API获取数据，并存到数据库中，然后通过图表展示到页面上，便于分析和比较不同平台的统计结果。

### 网页设计

原型设计（第二稿）可查看：

https://modao.cc/app/838161816523535692f1dcddc79a44f0567bd025?simulator_type=device&sticky

#### 时间选择悬浮栏

##### 日期范围选择

* 首次加载阶段显示内容：开始日期 - 结束日期
* 首次加载完毕默认值为 七天前 到 当日
* 不允许选择单日
* 当下拉选择框隐藏且时间数据发生变化时，重新载入数据

##### 提示按钮

* 鼠标悬停时提示当日数据截止到XX:XX

####  多日趋势对比图

* 折线图
* 加载阶段加载信息
* 横轴范围：开始日期-结束日期

* 纵轴名称：浏览量/访客数
* 纵轴范围：0 - 浏览量最大数值向上取整
* 鼠标悬停时：就近的日期上气泡提示框显示日期、类型、平台数据
* 异常时只显示异常信息

##### 平台复选框

* 加载阶段和异常时不显示
* 默认全部勾选
* 未勾选的平台将不予显示

##### PU/UV开关

* 首次加载阶段和异常时不显示
* 默认PV
* 改变开关选项时将改变纵轴名称、折线

#### 多日数据汇总表

* 加载阶段只显示表头和加载信息
* 异常时只显示表头和异常信息
* 固定表头，数据较多时可以滚动显示
* 以时间倒序排序
* 最后两列为该时间范围的数据总和和日均

#### 异常

* 隐藏折线图，显示异常信息
* 隐藏表格的数据栏，显示异常信息
* 日期选择器的内容变为：开始日期-结束日期
* 弹出消息通知，提醒用户重新选择日期或刷新页面



# 数据库表结构

表名：pvuv

| 字段名称  | 类型              | 宽度 | 允许空值 | 主键 | 说明   |
| --------- | ----------------- | ---- | -------- | ---- | ------ |
| id        | SMALLINT UNSIGNED | 2    | NOT NULL | true |        |
| date      | DATE              | 3    | NOT NULL |      | 日期   |
| baidu_pv  | SMALLINT UNSIGNED | 2    | NULL     |      | 百度PV |
| baidu_uv  | SMALLINT UNSIGNED | 2    | NULL     |      | 百度UV |
| google_pv | SMALLINT UNSIGNED | 2    | NULL     |      | 谷歌PV |
| google_uv | SMALLINT UNSIGNED | 2    | NULL     |      | 谷歌UV |
| umeng_pv  | SMALLINT UNSIGNED | 2    | NULL     |      | 友盟PV |
| umeng_uv  | SMALLINT UNSIGNED | 2    | NULL     |      | 友盟UV |

